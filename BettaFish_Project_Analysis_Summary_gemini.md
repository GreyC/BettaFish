### BettaFish 项目架构分析总结

这个项目是一个功能强大且复杂的**模块化舆情分析与报告生成系统**。它将数据采集、多维度分析和报告展示清晰地分离开来，形成一个完整的自动化流程。

**核心流程如下:**

1.  **数据采集 (MindSpider)**:
    *   作为整个系统的“数据触手”，`MindSpider` 负责从指定的中文社交媒体平台（如微博、小红书、抖音等）抓取原始帖子和评论。
    *   它首先提取热门话题，然后围绕这些话题进行深度内容抓取，并将所有数据存入系统的核心数据库中。

2.  **多维度分析 (三大引擎)**:
    *   数据入库后，三个独立的分析引擎会从不同角度对数据进行研究，它们都遵循着一套先进的“反思式”研究方法来自动生成深度分析报告（Markdown格式）。
    *   **`InsightEngine` (洞察引擎)**: **向内分析**。它深入挖掘 `MindSpider` 采集的内部数据库，进行深度的话题分析、情感洞察和趋势总结。
    *   **`MediaEngine` (媒体引擎)**: **向外分析**。它执行实时的网络搜索，从外部新闻和网站获取最新的信息和观点，为报告提供更广阔的上下文。
    *   **`QueryEngine` (查询引擎)**: **直接问答**。它被优化用于对数据库进行精确、事实性的查询，以回答特定的问题。

3.  **最终报告生成 (ReportEngine)**:
    *   这是流程的最后一站。`ReportEngine` 接收来自上述三个引擎的 Markdown 分析报告。
    *   它使用大语言模型（LLM）理解报告内容，并从一系列预设的模板（如“危机公关报告”、“市场分析报告”）中智能选择最合适的一个。
    *   最后，它将三份报告的内容“填入”选定的模板，生成一份精美的、格式统一的最终 HTML 报告。

4.  **统一指挥与展示 (app.py)**:
    *   `app.py` 是整个系统的“大脑”和“仪表盘”。它是一个 Flask Web 应用，负责：
        *   启动和管理所有后台模块（爬虫、分析引擎等）。
        *   提供一个统一的前端界面，让用户可以提交查询、监控各模块的运行状态和日志。
        *   协调整个流程，将用户的请求分发给相应的引擎，并最终调用 `ReportEngine` 汇总结果。

**技术亮点:**

*   **模块化设计**: 各个组件职责分明，可以独立运行和升级。
*   **LLM 深度应用**: 项目在分析的每一个环节（规划、搜索、总结、反思、格式化）都深度整合了大语言模型，实现了高度的自动化和智能化。
*   **内外部分析结合**: 通过 `InsightEngine` 和 `MediaEngine` 的分工，系统能够同时利用内部沉淀数据和外部实时信息，得出更全面、更立体的结论。

总而言之，**BettaFish 是一个从数据采集到深度分析，再到报告自动生成的全链路、智能化舆情分析平台。**